KISSY.add("malldetail/control/floatbar",function(e,t,a){return function(i){function n(){h?t.css(d,{"top":t.scrollTop()+f}):t.css(d,{"bottom":t.scrollTop()+f})}function o(){!0===r||!1!==r&&(h&&t.offset(u?m:d).top<t.scrollTop()+f||!h&&t.offset(u?m:d).top+t.outerHeight(u?m:d)>t.scrollTop()+t.viewportHeight()-f)?u||(s={},e.each(["position",h?"top":"bottom","display"],function(e){s[e]=d.style[e]}),e.UA.ie<=6?(p||(t.css(d,{"display":"none"}),p=!0),l&&clearTimeout(l),l=setTimeout(function(){t.css(d,{"display":"block","position":"absolute"}),a.on(window,"scroll",n),n(),p=!1},100)):t.css(d,h?{"position":"fixed","top":f}:{"position":"fixed","bottom":f}),t.css(m,{"height":t.outerHeight(d,!0)+"px","width":t.outerWidth(d,!0)+"px"}),u=!0,i.cls&&t.addClass(d,i.cls),i.onChange&&i.onChange(u)):u&&(l&&clearTimeout(l),a.remove(window,"scroll",n),t.css(d,s),t.css(m,{"height":"0"}),u=!1,i.cls&&t.removeClass(d,i.cls),i.onChange&&i.onChange(u))}var s,l,r,c=this,d=i.el,m=i.placeHolder||t.create("<div style='height:0;margin-top:0;margin-bottom:0;overflow:hidden;'></div>"),u=!1,p=!1,h=i.bottom===undefined,f=h?Number(i.top)||0:Number(i.bottom)||0;t.parent(d);t.insertAfter(m,d),a.on(window,"scroll",o),o(),e.mix(c,{"isFloating":function(){return u},"setMode":function(e){r=e,o()},"getPlaceHolder":function(){return m}})}},{"requires":["dom","event"]});